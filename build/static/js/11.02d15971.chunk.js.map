{"version":3,"sources":["pages/mobileHome.bak.js"],"names":["gameStatus","playerColorCodeOfIdx","MobileHomePage","useDeviceMotion","moveCounter","permissionGranted","setMoveCounter","setPermissionGranted","useState","gameStage","setGameStage","gameSelected","setGameSelected","score","setScore","alertText","setAlertText","isJoined","setIsJoined","stageChanging","setStageChanging","playerColorCode","setPlayerColorCode","shakeIconArray","setShakeIconArray","playerId","useParams","socket","useRef","gameWrapper","debugByKeyboard","event","isJoinedFlag","key","useEffect","document","addEventListener","removeEventListener","requestAnimationFrame","joinRoom","DeviceOrientationEvent","requestPermission","then","response","alert","catch","console","error","current","withSocketio","host","config","socketioHost","eventEmitters","emitter","data","ack","result","eventListeners","listener","callback","stageId","disconnect","log","Math","round","forEach","player","gameIdx","gameId","shake","emit","generateShakeIcon","randomScale","random","randomXStart","randomXEnd","randomY","randomRotationStart","randomRotationEnd","randomDuration","icon","className","styles","colorCodeInHex","initialStyles","bottom","left","transform","opacity","transition","finalStyles","prevShakeIconArray","ref","wrapper","join","onClick","selected","buttonsWrapper","Array","fill","map","_","idx","button","newGameIdx","gameButton","floor","toString","split","length","chr","style","backgroundColor","width","shareToFb","href","window","location","origin","target","joinButton"],"mappings":"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","file":"static/js/11.02d15971.chunk.js","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport {useParams} from 'react-router-dom';\r\n// import useDeviceOrientation from 'components/useDeviceOrientation';\r\nimport WaitingIcon from 'components/waitingIcon';\r\nimport FanIcon from 'components/fanIcon';\r\nimport FanIconSmall from 'components/fanIconSmall';\r\nimport ShakeIcon from 'components/shakeIcon';\r\n\r\nimport useDeviceMotion from 'components/useDeviceMotion';\r\n\r\nimport withSocketio from 'components/withSocketio';\r\n\r\nimport config from 'globals/config';\r\n\r\nimport styles from './mobileHome.module.css';\r\n\r\nconst gameStatus = {\r\n  idle:      0,\r\n  waiting:   1,\r\n  selecting: 2,\r\n  selected:  3,\r\n  ready:     4,\r\n  started:   5,\r\n  result:    6,\r\n  offline:   7, // should be not able to get this signal\r\n}\r\n\r\nconst playerColorCodeOfIdx = [\r\n  \"#ed334e\",\r\n  \"#00652e\",\r\n  \"#0080C7\",\r\n  \"#fbb130\",\r\n  \"#231f20\",\r\n];\r\nconst MobileHomePage = () => {\r\n  const [{moveCounter, permissionGranted}, {setMoveCounter, setPermissionGranted}] = useDeviceMotion();\r\n  // const [permissionGranted, setPermissionGranted] = useState(false);\r\n  const [gameStage, setGameStage] = useState(gameStatus['idle']);\r\n  const [gameSelected, setGameSelected] = useState(-1);\r\n  const [score, setScore] = useState(0);\r\n  const [alertText, setAlertText] = useState('');\r\n  const [isJoined, setIsJoined] = useState(false);\r\n  const [stageChanging, setStageChanging] = useState(-1);\r\n  const [playerColorCode, setPlayerColorCode] = useState(playerColorCodeOfIdx[0]);\r\n  const [shakeIconArray, setShakeIconArray] = useState([]);\r\n  const playerId = useParams('playerId');\r\n  const socket = useRef(null);\r\n  const gameWrapper = useRef(null);\r\n  const setGameWrapper = (ref) => gameWrapper.current = ref;\r\n  const requestPermission = () => {\r\n    // setPermissionGranted(true);\r\n    // temp disable\r\n    if (typeof(DeviceOrientationEvent) === \"function\" && typeof(DeviceOrientationEvent.requestPermission) === \"function\") {\r\n      // alert('DeviceOrientationEvent.requestPermission');\r\n      DeviceOrientationEvent.requestPermission().then(response => {\r\n          if (response == 'granted') {\r\n            setPermissionGranted(true);\r\n            // window.addEventListener('deviceorientation', onMotion, false);\r\n            // window.addEventListener('deviceorientation', (e) => {\r\n            //   // do something with e\r\n            // })\r\n          } else {\r\n            alert(\"...\");\r\n          }\r\n        })\r\n        .catch(console.error);\r\n    } else {\r\n      setPermissionGranted(true);\r\n      // alert('no DeviceOrientationEvent.requestPermission');\r\n      // window.addEventListener('deviceorientation', onMotion, false);\r\n    }\r\n  };\r\n\r\n  const debugByKeyboard = (event) => {\r\n    let isJoinedFlag = true;\r\n    switch (event.key) {\r\n      case \"1\":\r\n        isJoinedFlag = false;\r\n      case \"2\":\r\n      case \"3\":\r\n      case \"4\":\r\n      case \"5\":\r\n      case \"6\":\r\n      case \"7\":\r\n        setGameStage(event.key - 1);\r\n        setIsJoined(isJoinedFlag);\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n  useEffect(() => {\r\n    document.addEventListener(\"keyup\", debugByKeyboard);\r\n    return () => {\r\n      document.removeEventListener(\"keyup\", debugByKeyboard);\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    requestAnimationFrame(() => {\r\n      setStageChanging(gameStage);\r\n    });\r\n    if (gameStage === gameStatus.ready) {\r\n      setShakeIconArray([]);\r\n    }\r\n  }, [gameStage]);\r\n  const joinRoom = () => {\r\n    if (!permissionGranted) {\r\n      // setPermissionGranted(true);\r\n      requestPermission();\r\n    } else {\r\n      // socket.current.emit('joinRoom', playerId);\r\n    }\r\n  }\r\n  useEffect(() => {\r\n    if (permissionGranted) {\r\n      socket.current = withSocketio({\r\n        host: config.socketioHost,\r\n        eventEmitters: [\r\n          {\r\n            emitter: 'joinRoom',\r\n            data: playerId,\r\n            ack: (result) => {\r\n              // alert(result);\r\n              if (result['data'] !== \"joined\") {\r\n                setGameStage(gameStatus.offline);\r\n                setAlertText(result['data']);\r\n              } else {\r\n                setPlayerColorCode(\r\n                  playerColorCodeOfIdx[result['index']]\r\n                );\r\n              }\r\n            }\r\n          }\r\n        ],\r\n        eventListeners: [\r\n          {\r\n            listener: 'gameStage',\r\n            callback: (data) => {\r\n              const stageId = data['data'];\r\n              setGameStage(stageId);\r\n              // if (stageId === gameStatus.selecting) {\r\n              //   setGameSelected(0);\r\n              // } else \r\n              if (stageId === gameStatus.result) {\r\n                socket.current.disconnect();\r\n              }\r\n            }\r\n          },\r\n          {\r\n            listener: 'gameResult',\r\n            callback: (data) => {\r\n              console.log(data);\r\n              const score = data['data'];\r\n              setScore(Math.round(score));\r\n            }\r\n          },\r\n          {\r\n            listener: 'playersInfo',\r\n            callback: (data) => {\r\n              const players = data['data'];\r\n              players.forEach(player => {\r\n                if (player['playerId'] === playerId['playerId']) {\r\n                  setIsJoined(player['joined']);\r\n                }\r\n              });\r\n            }\r\n          },\r\n          {\r\n            listener: 'gameChoice',\r\n            callback: (data) => {\r\n              const gameIdx = data['data'];\r\n              setGameSelected(gameIdx);\r\n            }\r\n          },\r\n          {\r\n            listener: 'gameSelected',\r\n            callback: (data) => {\r\n              const gameId = data['data'];\r\n              setGameSelected(gameId);\r\n              // gameSelected.current = gameId;\r\n            }\r\n          },\r\n        ]\r\n      })\r\n    }\r\n  }, [permissionGranted]);\r\n  useEffect(() => {\r\n    if (moveCounter > 2) {\r\n      // socket.current.emit('shake');\r\n      shake();\r\n      setMoveCounter(0);\r\n    }\r\n  }, [moveCounter, gameStage]);\r\n  const shake = () => {\r\n    if (socket.current) {\r\n      socket.current.emit('shake');\r\n    }\r\n    // debugger;\r\n    // if (gameStage === gameStatus.ready || gameStage === gameStatus.started) {\r\n    generateShakeIcon();\r\n    // }\r\n  }\r\n  const generateShakeIcon = () => {\r\n    const randomScale = (Math.random() + 8) / 9;\r\n    const randomXStart = Math.random() * 50 - 25;\r\n    const randomXEnd = Math.random() * 30 - 10;\r\n    const randomY = Math.random() * 10 - 5;\r\n    const randomRotationStart = Math.random() * 180 - 90;\r\n    const randomRotationEnd = Math.random() * 90 - 45;\r\n    const randomDuration = Math.random() + 4;\r\n    const icon = <ShakeIcon \r\n      className={styles['shake-icon']} \r\n      colorCodeInHex={playerColorCode}\r\n      initialStyles={{\r\n        bottom: `${72 + randomY}vw`,\r\n        left: `${50 + randomXStart}%`,\r\n        transform: `translateX(-50%) scale(${randomScale}) rotate(${randomRotationStart}DEG)`,\r\n        opacity: 0.8,\r\n        transition: `all ${randomDuration}s`\r\n      }}\r\n      finalStyles={{\r\n        bottom: '100vh',\r\n        left: `${randomXEnd}%`,\r\n        transform: `translateX(-50%) scale(0) rotate(${randomRotationEnd}DEG)`,\r\n        opacity: 0,\r\n        transition: `all ${randomDuration}s`\r\n      }}\r\n    />;\r\n      \r\n    // icon.style = {\r\n    //   bottom: '72vw',\r\n    //   left: '50%',\r\n    //   transform: 'translateX(-50%)',\r\n    //   opacity: 0.8\r\n    // };\r\n    setShakeIconArray((prevShakeIconArray) => {\r\n      return [...prevShakeIconArray, icon];\r\n    })\r\n    // shakeIconArray.current.push(icon);\r\n  }\r\n  const selectGame = (gameIdx) => {\r\n    if (socket.current) {\r\n      socket.current.emit('selectGame', {\r\n        data: gameIdx\r\n      }, (data) => {\r\n        const newGameIdx = data['data'];\r\n        setGameSelected(newGameIdx);\r\n      });\r\n    } else {\r\n      if (gameSelected === gameIdx) {\r\n        setGameSelected(-1);\r\n      } else {\r\n        setGameSelected(gameIdx);\r\n      }\r\n    }\r\n\r\n  }\r\n  const setFullscreen = () => {\r\n    if (gameWrapper.current.requestFullscreen) { \r\n      gameWrapper.current.requestFullscreen({\r\n        navigationUI: \"hide\"\r\n      });\r\n    }\r\n  }\r\n  return <div ref={setGameWrapper} className={styles.wrapper}>\r\n    {{\r\n      [gameStatus.idle]: (\r\n        <div className={[styles['stage'], styles['stage-idle'], styles['active']].join(' ')}>\r\n          <div className={styles[\"background\"]}>\r\n            <div className={styles[\"texture\"]} />\r\n          </div>\r\n          <div className={[styles[\"marquee\"], styles[\"marqueeTop\"], styles[\"marqueeIdle\"]].join(' ')} />\r\n          <div className={[styles[\"marquee\"], styles[\"marqueeLeft\"], styles[\"marqueeIdle\"]].join(' ')} />\r\n          <div className={[styles[\"marquee\"], styles[\"marqueeBottom\"], styles[\"marqueeIdle\"]].join(' ')} />\r\n          <div className={[styles[\"marquee\"], styles[\"marqueeRight\"], styles[\"marqueeIdle\"]].join(' ')} />\r\n          <div className={styles[\"title\"]} />\r\n          <div className={[styles[\"counter\"], styles[\"counter1\"]].join(' ')}>\r\n            <div className={[styles[\"background-en\"]]} />\r\n            <div className={[styles[\"background-zh\"]]} />\r\n            <span>{2884}</span> km\r\n          </div>\r\n          <div className={[styles[\"counter\"], styles[\"counter2\"]].join(' ')}>\r\n            <div className={[styles[\"background-en\"]]} />\r\n            <div className={[styles[\"background-zh\"]]} />\r\n            <span>10</span>\r\n          </div>\r\n          <div className={styles[\"logo\"]} />\r\n          <div className={styles[\"join-game\"]} onClick={joinRoom}>\r\n            <div className={styles[\"text-en\"]}></div>\r\n            <div className={styles[\"text-zh\"]}></div>\r\n          </div>\r\n        </div>\r\n      ),\r\n      [gameStatus.waiting]: (\r\n        isJoined?\r\n        <div className={[styles['stage'], styles['stage-waiting'], (stageChanging === gameStatus.waiting? styles['active']: null)].join(' ')}>\r\n          <div className={styles[\"background\"]}>\r\n            <div className={styles[\"texture\"]} />\r\n            <WaitingIcon className={[styles[\"movingIcon\"], styles[\"movingIcon1\"]].join(' ')} colorCodeInHex={playerColorCode} />\r\n            <WaitingIcon className={[styles[\"movingIcon\"], styles[\"movingIcon2\"]].join(' ')} colorCodeInHex={playerColorCode} />\r\n            <WaitingIcon className={[styles[\"movingIcon\"], styles[\"movingIcon3\"]].join(' ')} colorCodeInHex={playerColorCode} />\r\n            <WaitingIcon className={[styles[\"movingIcon\"], styles[\"movingIcon4\"]].join(' ')} colorCodeInHex={playerColorCode} />\r\n          </div>\r\n          <div className={[styles[\"marquee\"], styles[\"marqueeTop\"], styles[\"marqueeWaiting\"]].join(' ')} />\r\n          <div className={[styles[\"marquee\"], styles[\"marqueeLeft\"], styles[\"marqueeWaiting\"]].join(' ')} />\r\n          <div className={[styles[\"marquee\"], styles[\"marqueeBottom\"], styles[\"marqueeWaiting\"]].join(' ')} />\r\n          <div className={[styles[\"marquee\"], styles[\"marqueeRight\"], styles[\"marqueeWaiting\"]].join(' ')} />\r\n          {/* <div className={styles.joinButton}>Wait for other players</div> */}\r\n        </div>\r\n        :\r\n        <div className={[styles['stage'], styles['stage-idle']].join(' ')}>\r\n          <div className={styles[\"background\"]}>\r\n            <div className={styles[\"texture\"]} />\r\n          </div>\r\n          <div className={styles[\"title\"]} />\r\n          <div className={[styles[\"counter\"], styles[\"counter1\"]].join(' ')}>\r\n            <div className={[styles[\"background-en\"]]} />\r\n            <div className={[styles[\"background-zh\"]]} />\r\n            <span>{1884}</span> km\r\n          </div>\r\n          <div className={[styles[\"counter\"], styles[\"counter2\"]].join(' ')}>\r\n            <span>10,000,121</span>\r\n          </div>\r\n          <div className={styles[\"logo\"]} />\r\n          <div className={styles[\"join-game\"]} onClick={joinRoom}></div>\r\n        </div>\r\n      ),\r\n      [gameStatus.selecting]: (\r\n        <div className={[styles['stage'], styles['stage-selecting'], (stageChanging === gameStatus.selecting? styles['active']: null), (gameSelected !== -1? styles.selected: null)].join(' ')}>\r\n          <div className={styles[\"background\"]}>\r\n            <div className={styles[\"texture\"]} />\r\n          </div>\r\n          <div className={[styles[\"marquee\"], styles[\"marqueeTop\"], styles[\"marqueeSelecting\"]].join(' ')} />\r\n          <div className={[styles[\"marquee\"], styles[\"marqueeLeft\"], styles[\"marqueeSelecting\"]].join(' ')} />\r\n          <div className={[styles[\"marquee\"], styles[\"marqueeBottom\"], styles[\"marqueeSelecting\"]].join(' ')} />\r\n          <div className={[styles[\"marquee\"], styles[\"marqueeRight\"], styles[\"marqueeSelecting\"]].join(' ')} />\r\n          \r\n          <div className={[styles.buttonsWrapper].join(' ')}>\r\n            {\r\n              new Array(3).fill(0).map((_, idx) => {\r\n                return (\r\n                  <div className={styles.button}>\r\n                    <button onClick={()=>selectGame(idx)} \r\n                      className={[styles.gameButton, styles[`gameButton${idx}`], (gameSelected === idx? styles.selected: null)].join(' ')}>\r\n                      <div className={styles[\"contentWrapper\"]}>\r\n                        <div className={styles[\"zh\"]} />\r\n                        <div className={styles[\"en\"]} />\r\n                        <div className={styles[\"ani\"]} />\r\n                      </div>\r\n                    </button>\r\n                  </div>\r\n                );\r\n              })\r\n            }\r\n          </div>\r\n        </div>\r\n      ),\r\n      [gameStatus.selected]: (\r\n        <div className={[styles['stage'], styles['stage-selected'], (stageChanging === gameStatus.selected? styles['active']: null)].join(' ')}>\r\n          <div className={styles[\"background\"]}>\r\n            <div className={styles[\"texture\"]} />\r\n          </div>\r\n          <div className={[styles[\"marquee\"], styles[\"marqueeTop\"], styles[\"marqueeSelecting\"]].join(' ')} />\r\n          <div className={[styles[\"marquee\"], styles[\"marqueeLeft\"], styles[\"marqueeSelecting\"]].join(' ')} />\r\n          <div className={[styles[\"marquee\"], styles[\"marqueeBottom\"], styles[\"marqueeSelecting\"]].join(' ')} />\r\n          <div className={[styles[\"marquee\"], styles[\"marqueeRight\"], styles[\"marqueeSelecting\"]].join(' ')} />\r\n          <div className={styles[\"title\"]} />\r\n          <div className={[styles[\"gameName\"], styles[`game${gameSelected}`]].join(' ')}>\r\n            <div className={styles[\"zh\"]} />\r\n            <div className={styles[\"en\"]} />\r\n          </div>\r\n          <div className={[styles[\"gacha\"], styles[\"gachaTop\"]].join(' ')} />\r\n          <div className={[styles[\"gacha\"], styles[\"gachaBottom\"]].join(' ')} />\r\n          <div className={[styles[\"result\"], styles[`result${gameSelected}`]].join(' ')} />\r\n        </div>\r\n      ),\r\n      [gameStatus.ready]: (\r\n        <div className={[styles['stage'], styles['stage-ready'], (stageChanging === gameStatus.ready? styles['active']: null)].join(' ')}>\r\n          <div className={styles[\"background\"]} />\r\n          <div className={styles[\"get-image\"]} />\r\n          <div className={styles[\"set-image\"]} />\r\n          <div onClick={shake}>\r\n            <FanIcon className={[styles[\"fanIcon\"]].join(' ')} colorCodeInHex={playerColorCode} />\r\n          </div>\r\n          {shakeIconArray}\r\n        </div>\r\n      ),\r\n      [gameStatus.started]: (\r\n        <div className={[styles['stage'], styles['stage-started'], (stageChanging === gameStatus.started? styles['active']: null)].join(' ')}>\r\n          <div className={styles[\"background\"]} />\r\n          <div className={styles[\"go-image\"]} />\r\n          <div onClick={shake}>\r\n            <FanIcon className={[styles[\"fanIcon\"]].join(' ')} colorCodeInHex={playerColorCode} />\r\n          </div>\r\n          {shakeIconArray}\r\n        </div>\r\n      ),\r\n      [gameStatus.result]: (\r\n        <div className={[styles['stage'], styles['stage-result'], (stageChanging === gameStatus.result? styles['active']: null)].join(' ')}>\r\n          <div className={styles[\"background\"]}>\r\n            <div className={styles[\"texture\"]} />\r\n          </div>\r\n          <div className={styles[\"splashScreen\"]}>\r\n            {new Array(10).fill(0).map((_, idx) => {\r\n              return <div className={[styles[\"banner-wrapper\"], styles[`bannerLot${Math.floor(idx / 5)}`], styles[`bannerType${idx % 5}`]].join(' ')}>\r\n                <div className={styles[\"banner\"]} />\r\n              </div>;\r\n            })}\r\n          </div>\r\n          <div className={styles[\"title\"]} />\r\n          <div className={styles[\"header\"]} />\r\n          <div className={[styles[\"score\"], styles[`digit${score.toString().split('').length}`]].join(' ')}>\r\n            {score.toString().split('').map((chr, idx) => {\r\n              return <span key={idx} className={[styles[\"number\"], styles[`number${chr}`]].join(' ')} />;\r\n            })}\r\n            <div className={styles[\"unit\"]}>km</div>\r\n            <div className={styles[\"remain\"]}>\r\n              <div className={styles[\"zh\"]}>{2884 - score}</div>\r\n              <div className={styles[\"en\"]}>{2884 - score} to go</div>\r\n            </div>\r\n          </div>\r\n          <div className={styles[\"bar-chart\"]}>\r\n            <div className={styles[\"bar\"]} style={{\r\n              backgroundColor: playerColorCode,\r\n              width: `${(stageChanging === gameStatus.result? Math.random() * 50 + 50: 0)}%`\r\n            }} />\r\n            <FanIconSmall className={styles[\"icon\"]} colorCodeInHex={playerColorCode} />\r\n          </div>\r\n          <div className={[styles[\"selected\"], styles[`selected${gameSelected}`]].join(' ')} />\r\n          <a className={styles.shareToFb} href={`https://www.facebook.com/sharer/sharer.php?u=${window.location.origin}&quote=I played Shake Shake Game and got ${score} marks !`} target=\"_blank\">\r\n            <div className={styles[\"zh\"]} />\r\n            <div className={styles[\"en\"]} />\r\n          </a>\r\n          {/* <div className={styles.joinButton}>\r\n            <div>Result</div>\r\n            <div className={styles.score}>{score}</div>\r\n            <a className={styles.shareToFb} href={`https://www.facebook.com/sharer/sharer.php?u=${window.location.origin}&quote=I played Shake Shake Game and got ${score} marks !`} target=\"_blank\">\r\n              Share\r\n            </a>\r\n          </div> */}\r\n        </div>\r\n      ),\r\n      [gameStatus.offline]: (\r\n        <div className={styles.joinButton}>\r\n          <div>{alertText}</div>\r\n        </div>\r\n      )\r\n    }[gameStage]}\r\n  </div>;\r\n}\r\n\r\nexport default MobileHomePage;"],"sourceRoot":""}