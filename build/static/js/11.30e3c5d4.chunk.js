(this.webpackJsonpolympic=this.webpackJsonpolympic||[]).push([[11],{27:function(e,a,t){"use strict";t.r(a);var n,c=t(52),r=t(41),l=t(48),s=t(0),o=t.n(s),m=t(5),i=function(e){var a=e.texts,t=e.breakTime,n=void 0===t?1500:t,c=e.duration,l=void 0===c?1e3:c,m=Object(s.useRef)(0),i=Object(s.useRef)(null),u=Object(s.useRef)([]),d=Object(s.useState)(""),v=Object(r.a)(d,2),E=v[0],f=v[1];Object(s.useEffect)((function(){return b(),function(){for(clearTimeout(i.current);u.current.length>0;){var e=u.current.pop();clearTimeout(e)}}}),[]);var b=function e(t){t?function(){for(var t=a[m.current],n=l/t.length,c=0;c<t.length;c++)!function(e){u.current.push(setTimeout((function(){f(t.substr(0,t.length-e-1))}),n*e))}(c);i.current=setTimeout((function(){return e()}),l),m.current=(m.current+1)%a.length}():function(){for(var t=a[m.current],c=l/t.length,r=0;r<t.length;r++)!function(e){u.current.push(setTimeout((function(){f(t.substr(0,e+1))}),c*e))}(r);i.current=setTimeout((function(){return e(!0)}),l+n)}()};return o.a.createElement(o.a.Fragment,null,E)},u=t(85),d=t(86),v=t(87),E=t(88),f=t(89),b=t(42),g=t(43),j=t(39),N=t.n(j),h=function(e){var a=Object(s.useState)(e),t=Object(r.a)(a,2),n=t[0],c=t[1],l=Object(s.useState)({}),o=Object(r.a)(l,2),m=o[0],i=o[1];return Object(s.useEffect)((function(){fetch(n,{}).then((function(e){return e.json()})).then((function(e){return i(e)})).catch((function(e){return alert(e)}))}),[n]),Object(s.useEffect)((function(){console.log(m)}),[m]),[m,c]},p=0,O=1,k=2,y=3,I=4,S=5,w=6,C=7,q=(n={},Object(l.a)(n,p,"stage-idle"),Object(l.a)(n,O,"stage-waiting"),Object(l.a)(n,k,"stage-selecting"),Object(l.a)(n,y,"stage-selected"),Object(l.a)(n,I,"stage-ready"),Object(l.a)(n,S,"stage-started"),Object(l.a)(n,w,"stage-result"),Object(l.a)(n,C,"stage-offline"),n),M=["red","yellow","blue"],T=["#ed334e","#00652e","#0080C7","#fbb130","#231f20"];a.default=function(){var e=Object(f.a)(),a=Object(r.a)(e,2),t=a[0],n=t.moveCounter,l=t.permissionGranted,j=a[1],x=j.setMoveCounter,H=j.setPermissionGranted,F=h(g.a.apiUrl),R=Object(r.a)(F,2),B=R[0],D=(R[1],Object(s.useState)(p)),L=Object(r.a)(D,2),G=L[0],z=L[1],P=Object(s.useState)(C),A=Object(r.a)(P,2),J=A[0],W=A[1],_=Object(s.useState)(!1),X=Object(r.a)(_,2),U=(X[0],X[1]),K=Object(s.useState)(T[0]),Q=Object(r.a)(K,2),V=Q[0],Y=Q[1],Z=Object(s.useState)(-1),$=Object(r.a)(Z,2),ee=$[0],ae=$[1],te=Object(s.useState)([]),ne=Object(r.a)(te,2),ce=ne[0],re=ne[1],le=Object(s.useState)(0),se=Object(r.a)(le,2),oe=se[0],me=se[1],ie=Object(s.useState)(""),ue=Object(r.a)(ie,2),de=ue[0],ve=ue[1],Ee=Object(s.useRef)(null),fe=Object(s.useRef)(null),be=Object(m.i)("playerId"),ge=function(){fe.current&&fe.current.emit("shake"),je()},je=function(){var e=(Math.random()+8)/9,a=50*Math.random()-25,t=30*Math.random()-10,n=10*Math.random()-5,r=180*Math.random()-90,l=90*Math.random()-45,s=Math.random()+4,m=o.a.createElement(E.a,{className:N.a["shake-icon"],colorCodeInHex:V,initialStyles:{bottom:"".concat(60+n,"vw"),left:"".concat(50+a,"%"),transform:"translateX(-50%) scale(".concat(e,") rotate(").concat(r,"DEG)"),opacity:.8,transition:"all ".concat(s,"s")},finalStyles:{bottom:"100vh",left:"".concat(t,"%"),transform:"translateX(-50%) scale(0) rotate(".concat(l,"DEG)"),opacity:0,transition:"all ".concat(s,"s")},key:Date.now()});re((function(e){return[].concat(Object(c.a)(e.slice(-15)),[m])}))};Object(s.useEffect)((function(){n>2&&(ge(),x(0))}),[n]),Object(s.useEffect)((function(){requestAnimationFrame((function(){W(G)})),G===I&&re([])}),[G]),Object(s.useEffect)((function(){l&&(fe.current=Object(b.a)({host:g.a.socketioHost,eventEmitters:[{emitter:"joinRoom",data:be,ack:function(e){"joined"!==e.data?(z(C),ve(e.data)):Y(T[e.index])}}],eventListeners:[{listener:"gameStage",callback:function(e){var a=e.data;z(a),a===w&&fe.current.disconnect()}},{listener:"gameResult",callback:function(e){console.log(e);var a=e.data;me(Math.round(a))}},{listener:"playersInfo",callback:function(e){e.data.forEach((function(e){e.playerId===be.playerId&&U(e.joined)}))}},{listener:"gameChoice",callback:function(e){var a=e.data;ae(a)}},{listener:"gameSelected",callback:function(e){var a=e.data;ae(a)}}]}))}),[l]),Object(s.useEffect)((function(){return document.addEventListener("keyup",Ne),function(){document.removeEventListener("keyup",Ne)}}),[]);var Ne=function(e){var a=!0;switch(e.key){case"1":a=!1;case"2":case"3":ae(-1);case"4":case"5":case"6":case"7":z(e.key-1),U(a)}};return o.a.createElement("div",{ref:function(e){return Ee.current=e},className:N.a.wrapper},o.a.createElement("div",{className:[N.a.stage,N.a[q[G]],J===G?N.a.active:null,-1!==ee?N.a.selected:null].join(" ")},o.a.createElement("div",{className:N.a.background},o.a.createElement("div",{className:N.a.texture})),o.a.createElement("div",{className:[N.a.marquee,N.a.marqueeTop,N.a.marqueeIdle].join(" ")}),o.a.createElement("div",{className:[N.a.marquee,N.a.marqueeLeft,N.a.marqueeIdle].join(" ")}),o.a.createElement("div",{className:[N.a.marquee,N.a.marqueeBottom,N.a.marqueeIdle].join(" ")}),o.a.createElement("div",{className:[N.a.marquee,N.a.marqueeRight,N.a.marqueeIdle].join(" ")}),G===p&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:N.a.title}),o.a.createElement("div",{className:[N.a.counter,N.a.counter1].join(" ")},o.a.createElement("span",null,B.d)," km",o.a.createElement("div",{className:N.a.counterHints},o.a.createElement(i,{texts:["\u7d2f\u7a4d\u8ddd\u96e2","Cumulative distance"]}))),o.a.createElement("div",{className:[N.a.counter,N.a.counter2].join(" ")},o.a.createElement("span",null,B.v),o.a.createElement("div",{className:N.a.counterHints},o.a.createElement(i,{texts:["\u7d2f\u7a4d\u4eba\u6578","Cumulative visits"]}))),o.a.createElement("div",{className:N.a.logo}),o.a.createElement("div",{className:N.a["join-game-button"],onClick:function(){l||("function"===typeof DeviceMotionEvent&&"function"===typeof DeviceMotionEvent.requestPermission?DeviceMotionEvent.requestPermission().then((function(e){"granted"==e?H(!0):alert("Please allow the Device Motion to start the game.\n\u8acb\u5141\u8a31\u4f7f\u7528\u88dd\u7f6e\u52a0\u901f\u8a08\u6b0a\u9650\u4ee5\u9032\u884c\u904a\u6232")})).catch(console.error):H(!0))}},o.a.createElement("div",{className:N.a.face},o.a.createElement(i,{texts:["\u7acb\u5373\u53c3\u52a0","Join game"]})),o.a.createElement("div",{className:N.a.shadow}))),G===O&&o.a.createElement(o.a.Fragment,null,o.a.createElement(u.a,{className:[N.a.movingIcon,N.a.movingIcon1].join(" "),colorCodeInHex:V}),o.a.createElement(u.a,{className:[N.a.movingIcon,N.a.movingIcon2].join(" "),colorCodeInHex:V}),o.a.createElement(u.a,{className:[N.a.movingIcon,N.a.movingIcon3].join(" "),colorCodeInHex:V}),o.a.createElement(u.a,{className:[N.a.movingIcon,N.a.movingIcon4].join(" "),colorCodeInHex:V})),G===k&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:[N.a.buttonsWrapper,-1!==ee?N.a.selected:null].join(" ")},new Array(3).fill(0).map((function(e,a){return o.a.createElement("div",{className:N.a.button},o.a.createElement("button",{onClick:function(){return e=a,void(fe.current?fe.current.emit("selectGame",{data:e},(function(e){var a=e.data;ae(a)})):ae(ee===e?-1:e));var e},className:[N.a.gameButton,N.a["gameButton".concat(a)],ee===a?N.a.selected:null].join(" ")},o.a.createElement("div",{className:N.a.contentWrapper},o.a.createElement("div",{className:N.a.zh}),o.a.createElement("div",{className:N.a.en}),o.a.createElement("div",{className:N.a.ani}))))})),o.a.createElement("div",{className:[N.a.gacha,N.a.red].join(" ")},o.a.createElement("div",{className:N.a.gachaTop}),o.a.createElement("div",{className:N.a.gachaBottom})),o.a.createElement("div",{className:[N.a.gacha,N.a.yellow].join(" ")},o.a.createElement("div",{className:N.a.gachaTop}),o.a.createElement("div",{className:N.a.gachaBottom})),o.a.createElement("div",{className:[N.a.gacha,N.a.blue].join(" ")},o.a.createElement("div",{className:N.a.gachaTop}),o.a.createElement("div",{className:N.a.gachaBottom})))),G===y&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:[N.a.title].join(" ")}),o.a.createElement("div",{className:[N.a.gameName,N.a["game".concat(ee)]].join(" ")},o.a.createElement("div",{className:N.a.loading},"Loading..."),o.a.createElement("div",{className:N.a.zh}),o.a.createElement("div",{className:N.a.en})),o.a.createElement("div",{className:[N.a.gacha,N.a.selected,N.a[M[ee]]].join(" ")},o.a.createElement("div",{className:N.a.gachaTop}),o.a.createElement("div",{className:N.a.gachaBottom})),o.a.createElement("div",{className:[N.a.resultWrapper].join(" ")},o.a.createElement("div",{className:[N.a.result,N.a["result".concat(ee)]].join(" ")}))),(G===I||G===S)&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:N.a["get-image"]}),o.a.createElement("div",{className:N.a["set-image"]}),o.a.createElement("div",{className:N.a["go-image"]}),o.a.createElement("div",{onClick:ge},o.a.createElement(d.a,{className:[N.a.fanIcon].join(" "),colorCodeInHex:V})),ce),G===w&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:N.a.background},o.a.createElement("div",{className:N.a.texture})),o.a.createElement("div",{className:N.a.splashScreen},new Array(10).fill(0).map((function(e,a){return o.a.createElement("div",{className:[N.a["banner-wrapper"],N.a["bannerLot".concat(Math.floor(a/5))],N.a["bannerType".concat(a%5)]].join(" ")},o.a.createElement("div",{className:N.a.banner}))}))),o.a.createElement("div",{className:N.a.title}),o.a.createElement("div",{className:N.a.header}),o.a.createElement("div",{className:[N.a.score,N.a["digit".concat(oe.toString().split("").length)]].join(" ")},oe.toString().split("").map((function(e,a){return o.a.createElement("span",{key:a,className:[N.a.number,N.a["number".concat(e)]].join(" ")})})),o.a.createElement("div",{className:N.a.unit},"km"),o.a.createElement("div",{className:N.a.remain},o.a.createElement("div",{className:N.a.zh},2884-oe),o.a.createElement("div",{className:N.a.en},2884-oe," to go"))),o.a.createElement("div",{className:N.a["bar-chart"]},o.a.createElement("div",{className:N.a.bar,style:{backgroundColor:V,width:"".concat(J===w?50*Math.random()+50:0,"%")}}),o.a.createElement(v.a,{className:N.a.icon,colorCodeInHex:V})),o.a.createElement("div",{className:[N.a.selected,N.a["selected".concat(ee)]].join(" ")}),o.a.createElement("a",{className:N.a.shareToFb,href:"https://www.facebook.com/sharer/sharer.php?u=".concat(window.location.origin,"&quote=I played Shake Shake Game and got ").concat(oe," marks !"),target:"_blank"},o.a.createElement("div",{className:N.a.zh}),o.a.createElement("div",{className:N.a.en}))),G===C&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:N.a.alertText,dangerouslySetInnerHTML:{__html:de}})),o.a.createElement("div",{id:N.a.debug},n,o.a.createElement("br",null),G,o.a.createElement("br",null),B.d+" "+B.v)))}}}]);
//# sourceMappingURL=11.30e3c5d4.chunk.js.map