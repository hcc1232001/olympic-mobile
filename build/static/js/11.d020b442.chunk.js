(this.webpackJsonpolympic=this.webpackJsonpolympic||[]).push([[11],{27:function(e,a,t){"use strict";t.r(a);var n,c=t(46),r=t(40),i=t(48),s=t(0),m=t.n(s),l=t(5),o=function(e){var a=e.texts,t=e.breakTime,n=void 0===t?1500:t,c=e.duration,i=void 0===c?1e3:c,l=Object(s.useRef)(0),o=Object(s.useRef)(null),u=Object(s.useRef)([]),d=Object(s.useState)(""),g=Object(r.a)(d,2),v=g[0],E=g[1];Object(s.useEffect)((function(){return f(),function(){for(clearTimeout(o.current);u.current.length>0;){var e=u.current.pop();clearTimeout(e)}}}),[]);var f=function e(t){t?function(){for(var t=a[l.current],n=i/t.length,c=0;c<t.length;c++)!function(e){u.current.push(setTimeout((function(){E(t.substr(0,t.length-e-1))}),n*e))}(c);o.current=setTimeout((function(){return e()}),i),l.current=(l.current+1)%a.length}():function(){for(var t=a[l.current],c=i/t.length,r=0;r<t.length;r++)!function(e){u.current.push(setTimeout((function(){E(t.substr(0,e+1))}),c*e))}(r);o.current=setTimeout((function(){return e(!0)}),i+n)}()};return m.a.createElement(m.a.Fragment,null,v)},u=t(84),d=t(85),g=t(86),v=t(87),E=t(88),f=function(e){var a=Object(s.useState)(0),t=Object(r.a)(a,2),n=t[0],i=t[1],m=Object(s.useState)([]),l=Object(r.a)(m,2),o=(l[0],l[1]);return Object(s.useEffect)((function(){e.length&&e.forEach((function(e){var a=new Image;a.onload=function(){requestAnimationFrame((function(){return i((function(e){return e+1}))}))},a.onerror=function(){requestAnimationFrame((function(){return i((function(e){return e+1}))}))},a.src=e,o((function(e){return[].concat(Object(c.a)(e),[a])}))}))}),[e]),[e.length?n/e.length:0]},p=t(41),b=t(42),h=t(39),j=t.n(h),N=function(e){var a=Object(s.useState)(e),t=Object(r.a)(a,2),n=t[0],c=t[1],i=Object(s.useState)({}),m=Object(r.a)(i,2),l=m[0],o=m[1];return Object(s.useEffect)((function(){fetch(n,{}).then((function(e){return e.json()})).then((function(e){return o(e)})).catch((function(e){return alert(e)}))}),[n]),Object(s.useEffect)((function(){console.log(l)}),[l]),[l,c]},O=0,y=1,k=2,w=3,I=4,S=5,q=6,M=7,z=(n={},Object(i.a)(n,O,"stage-idle"),Object(i.a)(n,y,"stage-waiting"),Object(i.a)(n,k,"stage-selecting"),Object(i.a)(n,w,"stage-selected"),Object(i.a)(n,I,"stage-ready"),Object(i.a)(n,S,"stage-started"),Object(i.a)(n,q,"stage-result"),Object(i.a)(n,M,"stage-offline"),n),C=["red","yellow","blue"],T=["#ed334e","#00652e","#0080C7","#fbb130","#231f20"],x=["/media/images/title.png","/media/images/idle.png","/media/images/landing-counter1.png","/media/images/landing-counter2.png","/media/images/logo-white.png","/media/images/waiting.png","/media/images/background-logo.png","/media/images/chosing.png","/media/sprites/sports.png","/media/images/atheletics-zh.png","/media/images/atheletics-en.png","/media/images/cycle-zh.png","/media/images/cycle-en.png","/media/images/swim-zh.png","/media/images/swim-en.png","/media/images/gacha-top-red.png","/media/images/gacha-bottom-red.png","/media/images/gacha-top-blue.png","/media/images/gacha-bottom-blue.png","/media/images/gacha-top-yellow.png","/media/images/gacha-bottom-yellow.png","/media/images/cheerhk.png","/media/images/atheletics-zh-inv.png","/media/images/atheletics-en-inv.png","/media/images/cycle-zh-inv.png","/media/images/cycle-en-inv.png","/media/images/swim-zh-inv.png","/media/images/swim-en-inv.png","/media/images/get.png","/media/images/set.png","/media/images/go.png","/media/images/congratz-red.png","/media/images/congratz-green.png","/media/images/congratz-yellow.png","/media/images/congratz-blue.png","/media/images/congratz-black.png","/media/images/result.png","/media/sprites/number.png","/media/images/remain-zh.png","/media/images/share-zh.png","/media/images/share-en.png"];a.default=function(){var e=f(x),a=Object(r.a)(e,1)[0],t=Object(E.a)(),n=Object(r.a)(t,2),i=n[0],h=i.moveCounter,F=i.permissionGranted,H=n[1],R=H.setMoveCounter,B=H.setPermissionGranted,D=N(b.a.apiUrl),L=Object(r.a)(D,2),G=L[0],A=(L[1],Object(s.useState)(O)),P=Object(r.a)(A,2),W=P[0],J=P[1],_=Object(s.useState)(M),X=Object(r.a)(_,2),U=X[0],K=X[1],Q=Object(s.useState)(!1),V=Object(r.a)(Q,2),Y=(V[0],V[1]),Z=Object(s.useState)(T[0]),$=Object(r.a)(Z,2),ee=$[0],ae=$[1],te=Object(s.useState)(-1),ne=Object(r.a)(te,2),ce=ne[0],re=ne[1],ie=Object(s.useState)([]),se=Object(r.a)(ie,2),me=se[0],le=se[1],oe=Object(s.useState)(0),ue=Object(r.a)(oe,2),de=ue[0],ge=ue[1],ve=Object(s.useState)(""),Ee=Object(r.a)(ve,2),fe=Ee[0],pe=Ee[1],be=Object(s.useRef)(null),he=Object(s.useRef)(null),je=Object(l.i)("playerId"),Ne=function(){he.current&&he.current.emit("shake"),Oe()},Oe=function(){var e=(Math.random()+8)/9,a=50*Math.random()-25,t=30*Math.random()-10,n=10*Math.random()-5,r=180*Math.random()-90,i=90*Math.random()-45,s=Math.random()+4,l=m.a.createElement(v.a,{className:j.a["shake-icon"],colorCodeInHex:ee,initialStyles:{bottom:"".concat(60+n,"vw"),left:"".concat(50+a,"%"),transform:"translateX(-50%) scale(".concat(e,") rotate(").concat(r,"DEG)"),opacity:.8,transition:"all ".concat(s,"s")},finalStyles:{bottom:"100vh",left:"".concat(t,"%"),transform:"translateX(-50%) scale(0) rotate(".concat(i,"DEG)"),opacity:0,transition:"all ".concat(s,"s")},key:"".concat(Date.now()).concat(Math.random())});requestAnimationFrame((function(){le((function(e){return[].concat(Object(c.a)(e.slice(-15)),[l])}))}))};Object(s.useEffect)((function(){h>2&&(Ne(),R(0))}),[h]),Object(s.useEffect)((function(){setTimeout((function(){K(W)}),20),W===I&&le([])}),[W]),Object(s.useEffect)((function(){F&&(he.current=Object(p.a)({host:b.a.socketioHost,eventEmitters:[{emitter:"joinRoom",data:je,ack:function(e){"joined"!==e.data?(J(M),pe(e.data)):ae(T[e.index])}}],eventListeners:[{listener:"gameStage",callback:function(e){var a=e.data;J(a),a===q&&he.current.disconnect()}},{listener:"gameResult",callback:function(e){console.log(e);var a=e.data;ge(Math.round(a))}},{listener:"playersInfo",callback:function(e){e.data.forEach((function(e){e.playerId===je.playerId&&Y(e.joined)}))}},{listener:"gameChoice",callback:function(e){var a=e.data;re(a)}},{listener:"gameSelected",callback:function(e){var a=e.data;re(a)}}]}))}),[F]),Object(s.useEffect)((function(){return document.addEventListener("keyup",ye),function(){document.removeEventListener("keyup",ye)}}),[]);var ye=function(e){var a=!0;switch(e.key){case"1":a=!1;case"2":case"3":re(-1);case"4":case"5":case"6":case"7":J(e.key-1),Y(a)}};return m.a.createElement("div",{ref:function(e){return be.current=e},className:j.a.wrapper},m.a.createElement("div",{className:[j.a.preloadWrapper,a<1?j.a.active:null].join(" ")},m.a.createElement("div",{className:j.a.progress},m.a.createElement("div",{className:j.a.bar,style:{width:"".concat(100*a,"%")}})),m.a.createElement("div",{className:j.a.percent},"".concat(Math.round(100*a),"%"))),m.a.createElement("div",{className:[j.a.stage,j.a[z[W]],U===W?j.a.active:null,-1!==ce?j.a.selected:null].join(" ")},m.a.createElement("div",{className:j.a.background},m.a.createElement("div",{className:j.a.texture})),m.a.createElement("div",{className:[j.a.marquee,j.a.marqueeTop,j.a.marqueeIdle].join(" ")}),m.a.createElement("div",{className:[j.a.marquee,j.a.marqueeLeft,j.a.marqueeIdle].join(" ")}),m.a.createElement("div",{className:[j.a.marquee,j.a.marqueeBottom,j.a.marqueeIdle].join(" ")}),m.a.createElement("div",{className:[j.a.marquee,j.a.marqueeRight,j.a.marqueeIdle].join(" ")}),W===O&&m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:j.a.title}),m.a.createElement("div",{className:[j.a.counter,j.a.counter1].join(" ")},m.a.createElement("span",null,G.d)," km",m.a.createElement("div",{className:j.a.counterHints},m.a.createElement(o,{texts:["\u7d2f\u7a4d\u8ddd\u96e2","Cumulative distance"]}))),m.a.createElement("div",{className:[j.a.counter,j.a.counter2].join(" ")},m.a.createElement("span",null,G.v),m.a.createElement("div",{className:j.a.counterHints},m.a.createElement(o,{texts:["\u7d2f\u7a4d\u4eba\u6578","Cumulative visits"]}))),m.a.createElement("div",{className:j.a.logo}),m.a.createElement("div",{className:j.a["join-game-button"],onClick:function(){F||("function"===typeof DeviceMotionEvent&&"function"===typeof DeviceMotionEvent.requestPermission?DeviceMotionEvent.requestPermission().then((function(e){"granted"==e?B(!0):alert("Please allow the Device Motion to start the game.\n\u8acb\u5141\u8a31\u4f7f\u7528\u88dd\u7f6e\u52a0\u901f\u8a08\u6b0a\u9650\u4ee5\u9032\u884c\u904a\u6232")})).catch(console.error):B(!0))}},m.a.createElement("div",{className:j.a.face},m.a.createElement(o,{texts:["\u7acb\u5373\u53c3\u52a0","Join game"]})),m.a.createElement("div",{className:j.a.shadow}))),W===y&&m.a.createElement(m.a.Fragment,null,m.a.createElement(u.a,{className:[j.a.movingIcon,j.a.movingIcon1].join(" "),colorCodeInHex:ee}),m.a.createElement(u.a,{className:[j.a.movingIcon,j.a.movingIcon2].join(" "),colorCodeInHex:ee}),m.a.createElement(u.a,{className:[j.a.movingIcon,j.a.movingIcon3].join(" "),colorCodeInHex:ee}),m.a.createElement(u.a,{className:[j.a.movingIcon,j.a.movingIcon4].join(" "),colorCodeInHex:ee})),W===k&&m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:[j.a.buttonsWrapper,-1!==ce?j.a.selected:null].join(" ")},new Array(3).fill(0).map((function(e,a){return m.a.createElement("div",{className:j.a.button},m.a.createElement("button",{onClick:function(){return e=a,void(he.current?he.current.emit("selectGame",{data:e},(function(e){var a=e.data;re(a)})):re(ce===e?-1:e));var e},className:[j.a.gameButton,j.a["gameButton".concat(a)],ce===a?j.a.selected:null].join(" ")},m.a.createElement("div",{className:j.a.contentWrapper},m.a.createElement("div",{className:j.a.zh}),m.a.createElement("div",{className:j.a.en}),m.a.createElement("div",{className:j.a.ani}))))})),m.a.createElement("div",{className:[j.a.gacha,j.a.red].join(" ")},m.a.createElement("div",{className:j.a.gachaTop}),m.a.createElement("div",{className:j.a.gachaBottom})),m.a.createElement("div",{className:[j.a.gacha,j.a.yellow].join(" ")},m.a.createElement("div",{className:j.a.gachaTop}),m.a.createElement("div",{className:j.a.gachaBottom})),m.a.createElement("div",{className:[j.a.gacha,j.a.blue].join(" ")},m.a.createElement("div",{className:j.a.gachaTop}),m.a.createElement("div",{className:j.a.gachaBottom})))),W===w&&m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:[j.a.title].join(" ")}),m.a.createElement("div",{className:[j.a.gameName,j.a["game".concat(ce)]].join(" ")},m.a.createElement("div",{className:j.a.loading},"Loading..."),m.a.createElement("div",{className:j.a.zh}),m.a.createElement("div",{className:j.a.en})),m.a.createElement("div",{className:[j.a.gacha,j.a.selected,j.a[C[ce]]].join(" ")},m.a.createElement("div",{className:j.a.gachaTop}),m.a.createElement("div",{className:j.a.gachaBottom})),m.a.createElement("div",{className:[j.a.resultWrapper].join(" ")},m.a.createElement("div",{className:[j.a.result,j.a["result".concat(ce)]].join(" ")}))),(W===I||W===S)&&m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:j.a["get-image"]}),m.a.createElement("div",{className:j.a["set-image"]}),m.a.createElement("div",{className:j.a["go-image"]}),m.a.createElement("div",{onClick:Ne},m.a.createElement(d.a,{className:[j.a.fanIcon].join(" "),colorCodeInHex:ee})),me.slice(-16)),W===q&&m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:j.a.background},m.a.createElement("div",{className:j.a.texture})),m.a.createElement("div",{className:j.a.splashScreen},new Array(10).fill(0).map((function(e,a){return m.a.createElement("div",{className:[j.a["banner-wrapper"],j.a["bannerLot".concat(Math.floor(a/5))],j.a["bannerType".concat(a%5)]].join(" ")},m.a.createElement("div",{className:j.a.banner}))}))),m.a.createElement("div",{className:j.a.title}),m.a.createElement("div",{className:j.a.header}),m.a.createElement("div",{className:[j.a.score,j.a["digit".concat(de.toString().split("").length)]].join(" ")},de.toString().split("").map((function(e,a){return m.a.createElement("span",{key:a,className:[j.a.number,j.a["number".concat(e)]].join(" ")})})),m.a.createElement("div",{className:j.a.unit},"km"),m.a.createElement("div",{className:j.a.remain},m.a.createElement("div",{className:j.a.zh},2884-de),m.a.createElement("div",{className:j.a.en},2884-de," to go"))),m.a.createElement("div",{className:j.a["bar-chart"]},m.a.createElement("div",{className:j.a.bar,style:{backgroundColor:ee,width:"".concat(U===q?50*Math.random()+50:0,"%")}}),m.a.createElement(g.a,{className:j.a.icon,colorCodeInHex:ee})),m.a.createElement("div",{className:[j.a.selected,j.a["selected".concat(ce)]].join(" ")}),m.a.createElement("a",{className:j.a.shareToFb,href:"https://www.facebook.com/sharer/sharer.php?u=".concat(window.location.origin,"&quote=I played Shake Shake Game and got ").concat(de," marks !"),target:"_blank"},m.a.createElement("div",{className:j.a.zh}),m.a.createElement("div",{className:j.a.en}))),W===M&&m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:j.a.alertText,dangerouslySetInnerHTML:{__html:fe}})),m.a.createElement("div",{id:j.a.debug},me.length,m.a.createElement("br",null),W,m.a.createElement("br",null),G.d+" "+G.v)))}}}]);
//# sourceMappingURL=11.d020b442.chunk.js.map