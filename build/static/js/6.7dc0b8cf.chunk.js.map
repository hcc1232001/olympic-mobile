{"version":3,"sources":["pages/testPage.js","../node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","components/useDeviceOrientation.js"],"names":["MobileHomePage","useDeviceOrientation","direction","speed","angle","permissionGranted","setPermissionGranted","useParams","onClick","DeviceOrientationEvent","requestPermission","then","response","catch","console","error","_slicedToArray","arr","i","Array","isArray","Symbol","iterator","Object","prototype","toString","call","_arr","_n","_d","_e","undefined","_s","_i","next","done","push","value","length","err","TypeError","useState","setDirection","setSpeed","setAngle","moveCounter","setMoveCounter","prevAngle","useRef","prevTime","useEffect","window","addEventListener","updateDeviceStatus","removeEventListener","lastAccVec3","event","alpha","beta","gamma","timeNow","Date","now","timeDelta","current","angleNow","angleDelta","Math","sign","deltaX","abs","deltaY","deltaZ","prevMoveCounter","max"],"mappings":"qJAsCeA,UAjCQ,WAAO,IAAD,EACgDC,cADhD,mBACpBC,EADoB,KACTC,EADS,KACFC,EADE,KACKC,EADL,KACwBC,EADxB,KAEVC,YAAU,YAoB3B,OAAO,8BACHF,GAAqB,4BAAQG,QApBP,WACe,oBAA5BC,wBAA+F,oBAA9CA,uBAAuBC,kBAEjFD,uBAAuBC,oBAAoBC,MAAK,SAAAC,GAC5B,WAAZA,GACFN,GAAqB,MAOxBO,MAAMC,QAAQC,OAEjBT,GAAqB,KAMA,UACvB,0CACA,6BAAMJ,GACN,sCACA,6BAAMC,GACN,sCACA,6BAAMC,M,gCC/BK,SAASY,EAAeC,EAAKC,GAC1C,OCJa,SAAyBD,GACtC,GAAIE,MAAMC,QAAQH,GAAM,OAAOA,EDGxB,CAAeA,IEJT,SAA+BA,EAAKC,GACjD,GAAMG,OAAOC,YAAYC,OAAON,IAAgD,uBAAxCM,OAAOC,UAAUC,SAASC,KAAKT,GAAvE,CAIA,IAAIU,EAAO,GACPC,GAAK,EACLC,GAAK,EACLC,OAAKC,EAET,IACE,IAAK,IAAiCC,EAA7BC,EAAKhB,EAAII,OAAOC,cAAmBM,GAAMI,EAAKC,EAAGC,QAAQC,QAChER,EAAKS,KAAKJ,EAAGK,QAETnB,GAAKS,EAAKW,SAAWpB,GAH8CU,GAAK,IAK9E,MAAOW,GACPV,GAAK,EACLC,EAAKS,EACL,QACA,IACOX,GAAsB,MAAhBK,EAAW,QAAWA,EAAW,SAC5C,QACA,GAAIJ,EAAI,MAAMC,GAIlB,OAAOH,GFvBuB,CAAqBV,EAAKC,IGJ3C,WACb,MAAM,IAAIsB,UAAU,wDHG0C,GAJhE,mC,mDI6DevC,IA3Dc,WAAO,IAAD,EACiBwC,oBAAS,GAD1B,mBAC1BpC,EAD0B,KACPC,EADO,OAECmC,mBAAS,GAFV,mBAE1BvC,EAF0B,KAEfwC,EAFe,OAGPD,mBAAS,GAHF,mBAG1BtC,EAH0B,KAGnBwC,EAHmB,OAIPF,mBAAS,GAJF,mBAI1BrC,EAJ0B,KAInBwC,EAJmB,OAKKH,mBAAS,GALd,mBAK1BI,EAL0B,KAKbC,EALa,KAM7BC,EAAYC,iBAAO,GACnBC,EAAWD,iBAAO,GACtBE,qBAAU,WAIR,OAHI7C,GACF8C,OAAOC,iBAAiB,oBAAqBC,GAAoB,GAE5D,WACLF,OAAOG,oBAAoB,oBAAqBD,GAAoB,MAErE,CAAChD,IAEJ,IAAIkD,EAAc,CAAC,KAAM,KAAM,MAEzBF,EAAqB,SAACG,GAAW,IAC9BC,EAAsBD,EAAtBC,MAAOC,EAAeF,EAAfE,KAAMC,EAASH,EAATG,MACdC,EAAUC,KAAKC,MACfC,EAAYH,EAAUX,EAASe,QAC/BC,EAAWR,EACbS,EAAaD,EAAWlB,EAAUiB,QAMtC,GALAf,EAASe,QAAUJ,EACnBb,EAAUiB,QAAUC,EACpBrB,EAASqB,GACTvB,EAAayB,KAAKC,KAAKF,IACvBvB,EAASuB,EAAaH,EAAY,KAC5BN,GAASC,GAAQC,EAAvB,CACA,IAAIU,EAASF,KAAKG,IAAIb,EAAQF,EAAY,IACtCgB,EAASJ,KAAKG,IAAIZ,EAAOH,EAAY,IACrCiB,EAASL,KAAKG,IAAIX,EAAQJ,EAAY,IAExCT,EADCuB,EAASE,EAASC,EAhBL,GAiBC,SAACC,GACd,OAAOA,EAAkB,GAGZ,SAACA,GACd,OAAON,KAAKO,IAAI,EAAGD,EAAkB,KAIzClB,EAAc,CAACE,EAAOC,EAAMC,KAG9B,MAAO,CAAC,CACNzD,YACAC,QACAC,QACAyC,cACAxC,qBACC,CACDC,uBACAwC","file":"static/js/6.7dc0b8cf.chunk.js","sourcesContent":["import React from 'react';\r\nimport {useParams} from 'react-router-dom';\r\nimport useDeviceOrientation from 'components/useDeviceOrientation';\r\n\r\n\r\nconst MobileHomePage = () => {\r\n  const [direction, speed, angle, permissionGranted, setPermissionGranted] = useDeviceOrientation();\r\n  const playerId = useParams('playerId');\r\n  const requestPermission = () => {\r\n    if (typeof(DeviceOrientationEvent) === \"function\" && typeof(DeviceOrientationEvent.requestPermission) === \"function\") {\r\n      // alert('DeviceOrientationEvent.requestPermission');\r\n      DeviceOrientationEvent.requestPermission().then(response => {\r\n          if (response == 'granted') {\r\n            setPermissionGranted(true);\r\n            // window.addEventListener('deviceorientation', onMotion, false);\r\n            // window.addEventListener('deviceorientation', (e) => {\r\n            //   // do something with e\r\n            // })\r\n          }\r\n        })\r\n        .catch(console.error);\r\n    } else {\r\n      setPermissionGranted(true);\r\n      // alert('no DeviceOrientationEvent.requestPermission');\r\n      // window.addEventListener('deviceorientation', onMotion, false);\r\n    }\r\n  };\r\n  return <div>\r\n    {!permissionGranted && <button onClick={requestPermission}>Start!</button>}\r\n    <div>direction</div>\r\n    <div>{direction}</div>\r\n    <div>speed</div>\r\n    <div>{speed}</div>\r\n    <div>angle</div>\r\n    <div>{angle}</div>\r\n  </div>;\r\n}\r\n\r\nexport default MobileHomePage;","import arrayWithHoles from \"./arrayWithHoles\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit\";\nimport nonIterableRest from \"./nonIterableRest\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}","import React, {useState, useEffect, useRef} from 'react';\r\n\r\nconst useDeviceOrientation = () => {\r\n  const [permissionGranted, setPermissionGranted] = useState(false);\r\n  const [direction, setDirection] = useState(0);\r\n  const [speed, setSpeed] = useState(0);\r\n  const [angle, setAngle] = useState(0);\r\n  const [moveCounter, setMoveCounter] = useState(0);\r\n  let prevAngle = useRef(0);\r\n  let prevTime = useRef(0);\r\n  useEffect(() => {\r\n    if (permissionGranted) {\r\n      window.addEventListener('deviceorientation', updateDeviceStatus, false);\r\n    }\r\n    return () => {\r\n      window.removeEventListener('deviceorientation', updateDeviceStatus, false);\r\n    }\r\n  }, [permissionGranted]);\r\n\r\n  let lastAccVec3 = [null, null, null];\r\n  const threshold = 45;\r\n  const updateDeviceStatus = (event) => {\r\n    const {alpha, beta, gamma} = event;\r\n    const timeNow = Date.now();\r\n    const timeDelta = timeNow - prevTime.current;\r\n    const angleNow = alpha;\r\n    let angleDelta = angleNow - prevAngle.current;\r\n    prevTime.current = timeNow;\r\n    prevAngle.current = angleNow;\r\n    setAngle(angleNow);\r\n    setDirection(Math.sign(angleDelta));\r\n    setSpeed(angleDelta / timeDelta * 1000);\r\n    if (!(alpha && beta && gamma)) { return; }\r\n    let deltaX = Math.abs(alpha - lastAccVec3[0]);\r\n    let deltaY = Math.abs(beta - lastAccVec3[1]);\r\n    let deltaZ = Math.abs(gamma - lastAccVec3[2]);\r\n    if(deltaX + deltaY + deltaZ > threshold) {\r\n      setMoveCounter((prevMoveCounter) => {\r\n        return prevMoveCounter + 1;\r\n      })\r\n    } else {\r\n      setMoveCounter((prevMoveCounter) => {\r\n        return Math.max(0, prevMoveCounter - 1);\r\n      })\r\n    }\r\n    // setLastAccVec3([alpha, beta, gamma]);\r\n    lastAccVec3 = [alpha, beta, gamma];\r\n  }\r\n  \r\n  return [{\r\n    direction, \r\n    speed, \r\n    angle,\r\n    moveCounter,\r\n    permissionGranted\r\n  }, {\r\n    setPermissionGranted,\r\n    setMoveCounter\r\n  }];\r\n}\r\n\r\nexport default useDeviceOrientation;"],"sourceRoot":""}