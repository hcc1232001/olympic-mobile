(this.webpackJsonpolympic=this.webpackJsonpolympic||[]).push([[7],{140:function(e,a,t){},27:function(e,a,t){"use strict";t.r(a);var n,c=t(46),r=t(40),i=t(48),s=t(0),l=t.n(s),m=t(5),o=(t(140),function(e){var a=e.texts,t=e.textsClass,n=void 0===t?["zh","en"]:t,c=e.breakTime,i=void 0===c?1500:c,m=e.duration,o=void 0===m?1e3:m,u=Object(s.useRef)(0),d=Object(s.useRef)(null),g=Object(s.useRef)([]),v=Object(s.useState)(""),f=Object(r.a)(v,2),E=f[0],p=f[1];Object(s.useEffect)((function(){return h(),function(){for(clearTimeout(d.current);g.current.length>0;){var e=g.current.pop();clearTimeout(e)}}}),[]);var h=function e(t){t?function(){for(var t=a[u.current],n=o/t.length,c=0;c<t.length;c++)!function(e){g.current.push(setTimeout((function(){p(t.substr(0,t.length-e-1))}),n*e))}(c);d.current=setTimeout((function(){return e()}),o)}():function(){u.current=(u.current+1)%a.length;for(var t=a[u.current],n=o/t.length,c=0;c<t.length;c++)!function(e){g.current.push(setTimeout((function(){p(t.substr(0,e+1))}),n*e))}(c);d.current=setTimeout((function(){return e(!0)}),o+i)}()};return l.a.createElement("div",{className:"animateText "+(n&&n.length?n[u.current]:"")},E)}),u=t(84),d=t(85),g=t(86),v=t(87),f=t(88),E=function(e){var a=Object(s.useState)(0),t=Object(r.a)(a,2),n=t[0],i=t[1],l=Object(s.useState)([]),m=Object(r.a)(l,2),o=(m[0],m[1]);return Object(s.useEffect)((function(){e.length&&e.forEach((function(e){var a=new Image;a.onload=function(){requestAnimationFrame((function(){return i((function(e){return e+1}))}))},a.onerror=function(){requestAnimationFrame((function(){return i((function(e){return e+1}))}))},a.src=e,o((function(e){return[].concat(Object(c.a)(e),[a])}))}))}),[e]),[e.length?n/e.length:0]},p=t(41),h=t(42),b=t(39),j=t.n(b),N=function(e){var a=Object(s.useState)(e),t=Object(r.a)(a,2),n=t[0],c=t[1],i=Object(s.useState)({}),l=Object(r.a)(i,2),m=l[0],o=l[1];return Object(s.useEffect)((function(){fetch(n,{}).then((function(e){return e.json()})).then((function(e){return o(e)})).catch((function(e){return alert(e)}))}),[n]),Object(s.useEffect)((function(){console.log(m)}),[m]),[m,c]},O=0,y=1,k=2,w=3,I=4,S=5,x=6,T=7,C=(n={},Object(i.a)(n,O,"stage-idle"),Object(i.a)(n,y,"stage-waiting"),Object(i.a)(n,k,"stage-selecting"),Object(i.a)(n,w,"stage-selected"),Object(i.a)(n,I,"stage-ready"),Object(i.a)(n,S,"stage-started"),Object(i.a)(n,x,"stage-result"),Object(i.a)(n,T,"stage-offline"),n),q=["red","yellow","blue"],M=["#ed334e","#00652e","#0080C7","#fbb130","#231f20"],z=["/media/images/title.png","/media/images/idle.png","/media/images/landing-counter1.png","/media/images/landing-counter2.png","/media/images/logo-white.png","/media/images/waiting.png","/media/images/background-logo.png","/media/images/chosing.png","/media/sprites/sports.png","/media/images/atheletics-zh.png","/media/images/atheletics-en.png","/media/images/cycle-zh.png","/media/images/cycle-en.png","/media/images/swim-zh.png","/media/images/swim-en.png","/media/images/gacha-top-red.png","/media/images/gacha-bottom-red.png","/media/images/gacha-top-blue.png","/media/images/gacha-bottom-blue.png","/media/images/gacha-top-yellow.png","/media/images/gacha-bottom-yellow.png","/media/images/cheerhk.png","/media/images/atheletics-zh-inv.png","/media/images/atheletics-en-inv.png","/media/images/cycle-zh-inv.png","/media/images/cycle-en-inv.png","/media/images/swim-zh-inv.png","/media/images/swim-en-inv.png","/media/images/get.png","/media/images/set.png","/media/images/go.png","/media/images/congratz-red.png","/media/images/congratz-green.png","/media/images/congratz-yellow.png","/media/images/congratz-blue.png","/media/images/congratz-black.png","/media/images/result.png","/media/sprites/number.png","/media/images/remain-zh.png"],A=function(e){return"number"===typeof e?e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"string"===typeof e?e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):e};a.default=function(){var e=E(z),a=Object(r.a)(e,1)[0],t=Object(f.a)(),n=Object(r.a)(t,2),i=n[0],b=i.moveCounter,F=i.permissionGranted,H=n[1],B=H.setMoveCounter,R=H.setPermissionGranted,L=N(h.a.apiUrl),D=Object(r.a)(L,2),G=D[0],P=(D[1],Object(s.useState)(O)),W=Object(r.a)(P,2),J=W[0],_=W[1],X=Object(s.useState)(T),K=Object(r.a)(X,2),U=K[0],Q=K[1],V=Object(s.useState)(!1),Y=Object(r.a)(V,2),Z=(Y[0],Y[1]),$=Object(s.useState)(M[0]),ee=Object(r.a)($,2),ae=ee[0],te=ee[1],ne=Object(s.useState)(-1),ce=Object(r.a)(ne,2),re=ce[0],ie=ce[1],se=Object(s.useState)([]),le=Object(r.a)(se,2),me=le[0],oe=le[1],ue=Object(s.useState)(0),de=Object(r.a)(ue,2),ge=de[0],ve=de[1],fe=Object(s.useState)(""),Ee=Object(r.a)(fe,2),pe=Ee[0],he=Ee[1],be=Object(s.useRef)(null),je=Object(s.useRef)(null),Ne=Object(m.i)("playerId"),Oe=function(){je.current&&je.current.emit("shake"),ye()},ye=function(){var e=(Math.random()+8)/9,a=50*Math.random()-25,t=30*Math.random()-10,n=10*Math.random()-5,r=180*Math.random()-90,i=90*Math.random()-45,s=Math.random()+4,m=l.a.createElement(v.a,{className:j.a["shake-icon"],colorCodeInHex:ae,initialStyles:{bottom:"".concat(60+n,"vw"),left:"".concat(50+a,"%"),transform:"translateX(-50%) scale(".concat(e,") rotate(").concat(r,"DEG)"),opacity:.8,transition:"all ".concat(s,"s")},finalStyles:{bottom:"100vh",left:"".concat(t,"%"),transform:"translateX(-50%) scale(0) rotate(".concat(i,"DEG)"),opacity:0,transition:"all ".concat(s,"s")},key:"".concat(Date.now()).concat(Math.random())});requestAnimationFrame((function(){oe((function(e){return[].concat(Object(c.a)(e.slice(-15)),[m])}))}))};Object(s.useEffect)((function(){b>2&&(Oe(),B(0))}),[b]),Object(s.useEffect)((function(){setTimeout((function(){Q(J)}),20),J===I&&oe([])}),[J]),Object(s.useEffect)((function(){F&&(je.current=Object(p.a)({host:h.a.socketioHost,eventEmitters:[{emitter:"joinRoom",data:Ne,ack:function(e){"joined"!==e.data?(_(T),he(e.data)):te(M[e.index])}}],eventListeners:[{listener:"gameStage",callback:function(e){var a=e.data;_(a),a===x&&je.current.disconnect()}},{listener:"gameResult",callback:function(e){console.log(e);var a=e.data;ve(Math.round(a))}},{listener:"playersInfo",callback:function(e){e.data.forEach((function(e){e.playerId===Ne.playerId&&Z(e.joined)}))}},{listener:"gameChoice",callback:function(e){var a=e.data;ie(a)}},{listener:"gameSelected",callback:function(e){var a=e.data;ie(a)}}]}))}),[F]),Object(s.useEffect)((function(){return document.addEventListener("keyup",ke),function(){document.removeEventListener("keyup",ke)}}),[]);var ke=function(e){var a=!0;switch(e.key){case"1":a=!1;case"2":case"3":ie(-1);case"4":case"5":case"6":case"7":_(e.key-1),Z(a)}};return l.a.createElement("div",{ref:function(e){return be.current=e},className:j.a.wrapper},l.a.createElement("div",{className:[j.a.preloadWrapper,a<1?j.a.active:null].join(" ")},l.a.createElement("div",{className:j.a.progress},l.a.createElement("div",{className:j.a.bar,style:{width:"".concat(100*a,"%")}})),l.a.createElement("div",{className:j.a.percent},"".concat(Math.round(100*a),"%"))),l.a.createElement("div",{className:[j.a.stage,j.a[C[J]],U===J?j.a.active:null,-1!==re?j.a.selected:null].join(" ")},l.a.createElement("div",{className:j.a.background},l.a.createElement("div",{className:j.a.texture})),l.a.createElement("div",{className:[j.a.marquee,j.a.marqueeTop,j.a.marqueeIdle].join(" ")}),l.a.createElement("div",{className:[j.a.marquee,j.a.marqueeLeft,j.a.marqueeIdle].join(" ")}),l.a.createElement("div",{className:[j.a.marquee,j.a.marqueeBottom,j.a.marqueeIdle].join(" ")}),l.a.createElement("div",{className:[j.a.marquee,j.a.marqueeRight,j.a.marqueeIdle].join(" ")}),J===O&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:j.a.title}),l.a.createElement("div",{className:[j.a.counter,j.a.counter1].join(" ")},l.a.createElement("span",null,A(G.d))," km",l.a.createElement("div",{className:j.a.counterHints},l.a.createElement(o,{textsClass:["zh","en"],texts:["\u7d2f\u7a4d\u8ddd\u96e2","Cumulative distance"]}))),l.a.createElement("div",{className:[j.a.counter,j.a.counter2].join(" ")},l.a.createElement("span",null,A(G.v)),l.a.createElement("div",{className:j.a.counterHints},l.a.createElement(o,{texts:["\u7d2f\u7a4d\u4eba\u6578","Cumulative visits"]}))),l.a.createElement("div",{className:j.a.logo}),l.a.createElement("div",{className:j.a["join-game-button"],onClick:function(){F||("function"===typeof DeviceMotionEvent&&"function"===typeof DeviceMotionEvent.requestPermission?DeviceMotionEvent.requestPermission().then((function(e){"granted"==e?R(!0):alert("Please allow the Device Motion to start the game.\n\u8acb\u5141\u8a31\u4f7f\u7528\u88dd\u7f6e\u52a0\u901f\u8a08\u6b0a\u9650\u4ee5\u9032\u884c\u904a\u6232")})).catch(console.error):R(!0))}},l.a.createElement("div",{className:j.a.face},l.a.createElement(o,{texts:["\u7acb\u5373\u53c3\u52a0","Join game"]})),l.a.createElement("div",{className:j.a.shadow}))),J===y&&l.a.createElement(l.a.Fragment,null,l.a.createElement(u.a,{className:[j.a.movingIcon,j.a.movingIcon1].join(" "),colorCodeInHex:ae}),l.a.createElement(u.a,{className:[j.a.movingIcon,j.a.movingIcon2].join(" "),colorCodeInHex:ae}),l.a.createElement(u.a,{className:[j.a.movingIcon,j.a.movingIcon3].join(" "),colorCodeInHex:ae}),l.a.createElement(u.a,{className:[j.a.movingIcon,j.a.movingIcon4].join(" "),colorCodeInHex:ae})),J===k&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:[j.a.buttonsWrapper,-1!==re?j.a.selected:null].join(" ")},new Array(3).fill(0).map((function(e,a){return l.a.createElement("div",{className:j.a.button},l.a.createElement("button",{onClick:function(){return e=a,void(je.current?je.current.emit("selectGame",{data:e},(function(e){var a=e.data;ie(a)})):ie(re===e?-1:e));var e},className:[j.a.gameButton,j.a["gameButton".concat(a)],re===a?j.a.selected:null].join(" ")},l.a.createElement("div",{className:j.a.contentWrapper},l.a.createElement("div",{className:j.a.zh},l.a.createElement("div",{className:j.a.textImg})),l.a.createElement("div",{className:j.a.en},l.a.createElement("div",{className:j.a.textImg})),l.a.createElement("div",{className:j.a.ani}))))})),l.a.createElement("div",{className:[j.a.gacha,j.a.red].join(" ")},l.a.createElement("div",{className:j.a.gachaTop}),l.a.createElement("div",{className:j.a.gachaBottom})),l.a.createElement("div",{className:[j.a.gacha,j.a.yellow].join(" ")},l.a.createElement("div",{className:j.a.gachaTop}),l.a.createElement("div",{className:j.a.gachaBottom})),l.a.createElement("div",{className:[j.a.gacha,j.a.blue].join(" ")},l.a.createElement("div",{className:j.a.gachaTop}),l.a.createElement("div",{className:j.a.gachaBottom})))),J===w&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:[j.a.title].join(" ")}),l.a.createElement("div",{className:[j.a.gameName,j.a["game".concat(re)]].join(" ")},l.a.createElement("div",{className:j.a.loading},"Loading..."),l.a.createElement("div",{className:j.a.zh}),l.a.createElement("div",{className:j.a.en})),l.a.createElement("div",{className:[j.a.gacha,j.a.selected,j.a[q[re]]].join(" ")},l.a.createElement("div",{className:j.a.gachaTop}),l.a.createElement("div",{className:j.a.gachaBottom})),l.a.createElement("div",{className:[j.a.resultWrapper].join(" ")},l.a.createElement("div",{className:[j.a.result,j.a["result".concat(re)]].join(" ")}))),(J===I||J===S)&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:j.a["get-image"]}),l.a.createElement("div",{className:j.a["set-image"]}),l.a.createElement("div",{className:j.a["go-image"]}),l.a.createElement("div",{onClick:Oe},l.a.createElement(d.a,{className:[j.a.fanIcon].join(" "),colorCodeInHex:ae})),me),J===x&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:j.a.background},l.a.createElement("div",{className:j.a.texture})),l.a.createElement("div",{className:j.a.splashScreen},new Array(10).fill(0).map((function(e,a){return l.a.createElement("div",{className:[j.a["banner-wrapper"],j.a["bannerLot".concat(Math.floor(a/5))],j.a["bannerType".concat(a%5)]].join(" ")},l.a.createElement("div",{className:j.a.banner}))}))),l.a.createElement("div",{className:j.a.title}),l.a.createElement("div",{className:j.a.header}),l.a.createElement("div",{className:[j.a.score,j.a["digit".concat(ge.toString().split("").length)]].join(" ")},ge.toString().split("").map((function(e,a){return l.a.createElement("span",{key:a,className:[j.a.number,j.a["number".concat(e)]].join(" ")})})),l.a.createElement("div",{className:j.a.unit},"km"),l.a.createElement("div",{className:j.a.remain},l.a.createElement("div",{className:j.a.zh},A(2884-ge)))),l.a.createElement("div",{className:j.a["bar-chart"]},l.a.createElement("div",{className:j.a.bar,style:{backgroundColor:ae,width:"".concat(U===x?50*Math.random()+50:0,"%")}}),l.a.createElement(g.a,{className:j.a.icon,colorCodeInHex:ae})),l.a.createElement("div",{className:[j.a.selected,j.a["selected".concat(re)]].join(" ")}),l.a.createElement("a",{className:j.a.shareToFb,href:"https://www.facebook.com/sharer/sharer.php?u=".concat(window.location.origin+"/share.html","&quote=\u6211\u652f\u6301\u5497\u5587! \u5927\u5bb6\u90fd\u4e00\u9f4a\u73a9\u5566~%0A%23\u9ad4\u80b2\u7bc0 %23\u5168\u6c11\u904b\u52d5%0A%23\u9081\u5411\u6771\u4eac %23\u652f\u6301\u9999\u6e2f\u904b\u52d5\u54e1%0AI have showed my support! Let\u2019s join together~%0A%23FestivalofSport %23SportforAll%0A%23RoadtoTokyo %23SupportHKAthletes%0A%0Ahttps://fos.hkolympic.org/"),target:"_blank"},l.a.createElement("div",{className:j.a.face},l.a.createElement(o,{duration:500,breakTime:2e3,texts:["\u7acb\u5373\u5206\u4eab","Share"]})),l.a.createElement("div",{className:j.a.shadow}))),J===T&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:j.a.alertText,dangerouslySetInnerHTML:{__html:pe}})),l.a.createElement("div",{id:j.a.debug},me.length,l.a.createElement("br",null),J,l.a.createElement("br",null),G.d+" "+G.v)))}}}]);
//# sourceMappingURL=7.d06fb0e8.chunk.js.map